<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>World CO₂ Emissions Analysis</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://unpkg.com/topojson@3"></script>
  <style>
    .country {
      fill: #ccc;
      stroke: #333;
    }

    .contours {
      opacity: 0.7;
    }

    .outline {
      fill: none;
      stroke: #000;
    }
  </style>
</head>

<body>
  <svg id="co2" height="800" width="1200" style="background: #fff; margin-top: 50px"> </svg>

  <script>
    // Select the SVG and define width and height
    const co2_svg = d3.select("#co2");
    const co2_width = co2_svg.attr("width");
    const co2_height = co2_svg.attr("height");
    const co2_map = co2_svg.append("g");

    // Function to load data and render the map
    async function requestDataFF() {
      // Load TopoJSON and CO₂ emissions data
      const world = await d3.json("./countries-110m.json");
      const co2_emissions = await d3.csv("./co2_emissions_kt_by_country.csv", d3.autoType);

      // Use Mercator projection for a global map view
      const projection = d3.geoMercator()
                           .scale(200)
                           .translate([co2_width / 2, co2_height / 1.4]);

      const path = d3.geoPath().projection(projection);

      // Convert TopoJSON to GeoJSON for rendering each country
      const countries = topojson.feature(world, world.objects.countries).features;

      // Draw the countries with a default fill color
      co2_map.selectAll("path.country")
        .data(countries)
        .join("path")
        .attr("class", "country")
        .attr("d", path);
    }
    
    // Run the function to load and display the data
    requestDataFF().catch(error => console.error("Error loading data:", error));
  </script>
</body>

</html>
